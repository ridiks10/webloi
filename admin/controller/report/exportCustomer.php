<?php/** * PHPExcel * * Copyright (C) 2006 - 2014 PHPExcel * * This library is free software; you can redistribute it and/or * modify it under the terms of the GNU Lesser General Public * License as published by the Free Software Foundation; either * version 2.1 of the License, or (at your option) any later version. * * This library is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU * Lesser General Public License for more details. * * You should have received a copy of the GNU Lesser General Public * License along with this library; if not, write to the Free Software * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA * * @category   PHPExcel * @package    PHPExcel * @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel) * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt	LGPL * @version    1.8.0, 2014-03-02 */class ControllerReportExportCustomer extends Controller {	public function exportgd() {/** Error reporting */error_reporting(E_ALL);ini_set('display_errors', TRUE);ini_set('display_startup_errors', TRUE);date_default_timezone_set('Europe/London');if (PHP_SAPI == 'cli')	die('This example should only be run from a Web Browser');/** Include PHPExcel */require_once dirname(__FILE__) . '/PHPExcel.php';		$this->load->language('sale/customer');		$this->load->model('sale/customer');						$results = $this -> model_sale_customer -> get_gd_current_date();			//echo "<pre>"; print_r($results); echo "</pre>"; die();			//echo "<pre>"; print_r($results); echo "</pre>"; die();		!count($results) > 0 && die('no data!');		foreach ($results as $key => $result) {				$customers[] = array(				'customer_id'    => $result['customer_id'],				'username'  => $result['username'],				'telephone'  => $result['telephone'],				'email'  => $result['email'],				'wallet'  => $result['wallet'],				'date_added'    => $result['date_added'],				'amount'    => $result['amount'],				'status'    => $result['status']							);		}// Create new PHPExcel object			$objPHPExcel = new PHPExcel();// Set document properties			$objPHPExcel->getProperties()->setCreator("Hoivien")							 ->setLastModifiedBy("Hoivien")							 ->setTitle("Office 2007 XLSX".$this->language->get('heading_title'))							 ->setSubject("Office 2007 XLSX".$this->language->get('heading_title'))							 ->setDescription($this->language->get('heading_title'))							 ->setKeywords("office 2007 openxml php")							 ->setCategory("Test result file");			$objPHPExcel->setActiveSheetIndex(0)            ->setCellValue('A1', 'STT')            ->setCellValue('B1', 'UserID')            ->setCellValue('C1', 'Username')            ->setCellValue('D1', 'Phone number')            ->setCellValue('E1', 'Email')            ->setCellValue('F1', 'Wallet')            ->setCellValue('G1', 'DateCreate')            ->setCellValue('H1', 'Amount')            ->setCellValue('I1', 'Status');			$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('B')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setWidth(20);			$objPHPExcel->getActiveSheet()->getColumnDimension('D')->setWidth(20);			$objPHPExcel->getActiveSheet()->getColumnDimension('E')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('F')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('G')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('H')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('I')->setWidth(10);			$h=0;			$n = 2;			foreach ($customers as $customer) {				$h++;						$objPHPExcel->getActiveSheet()->setCellValue('A'.$n,$h);				$objPHPExcel->getActiveSheet()->setCellValue('B'.$n,$customer['customer_id']);				$objPHPExcel->getActiveSheet()->setCellValue('C'.$n,$customer['username']);				$objPHPExcel->getActiveSheet()->setCellValue('D'.$n,$customer['telephone']);				$objPHPExcel->getActiveSheet()->setCellValue('E'.$n,$customer['email']);				$objPHPExcel->getActiveSheet()->setCellValue('F'.$n,$customer['wallet']);				$objPHPExcel->getActiveSheet()->setCellValue('G'.$n,$customer['date_added']);				$objPHPExcel->getActiveSheet()->setCellValue('H'.$n,($customer['amount']/100000000).' BTC');				if (intval($customer['status']) == 0) {					$status = 'Waiting';				}				if (intval($customer['status']) == 1) {					$status = 'Active';				}				if (intval($customer['status']) == 2) {					$status = 'Finish';				}				$objPHPExcel->getActiveSheet()->setCellValue('I'.$n,$status);				$n++;				}			$objPHPExcel->getActiveSheet()->getStyle('N'.$n.':'.'P'.$n)			->applyFromArray(				array('font'  => array(					'bold'  => true,					'size'  => 12,					'name'  => 'Arial'				))			);			// Rename worksheet			$objPHPExcel->getActiveSheet()->setTitle($this->language->get('heading_title'));			// Set active sheet index to the first sheet, so Excel opens this as the first sheet			$objPHPExcel->setActiveSheetIndex(0);			// Redirect output to a client’s web browser (Excel5)			header('Content-Type: application/vnd.ms-excel');			header('Content-Disposition: attachment;filename="LISTGD.xls"');			header('Cache-Control: max-age=0');			// If you're serving to IE 9, then the following may be needed			header('Cache-Control: max-age=1');			// If you're serving to IE over SSL, then the following may be needed			header ('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); // Date in the past			header ('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT'); // always modified			header ('Cache-Control: cache, must-revalidate'); // HTTP/1.1			header ('Pragma: public'); // HTTP/1.0			$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');			$objWriter->save('php://output');			exit;	}	public function get_parrent($customer_id){		$this->load->model('sale/customer');		$parrent = $this -> model_sale_customer -> get_customer_parrent($customer_id);		return $parrent['username'];	}	public function get_customer_p_binary($customer_id){		$this->load->model('sale/customer');		$parrent = $this -> model_sale_customer -> get_customer_by_p_binary($customer_id);		return $parrent['username'];	}	public function exportcustomer() {/** Error reporting */error_reporting(E_ALL);ini_set('display_errors', TRUE);ini_set('display_startup_errors', TRUE);date_default_timezone_set('Europe/London');if (PHP_SAPI == 'cli')	die('This example should only be run from a Web Browser');/** Include PHPExcel */require_once dirname(__FILE__) . '/PHPExcel.php';		$this->load->language('sale/customer');		$this->load->model('sale/customer');						$results = $this -> model_sale_customer -> getall_all_customer();			//echo "<pre>"; print_r($results); echo "</pre>"; die();			//echo "<pre>"; print_r($results); echo "</pre>"; die();		!count($results) > 0 && die('no data!');		foreach ($results as $key => $result) {				$customers[] = array(				'customer_id'    => $result['customer_id'],				'username'  => $result['username'],				'telephone'  => $result['telephone'],				'email'  => $result['email'],				'wallet'  => $result['wallet'],				'date_added'    => $result['date_added'],				'p_node' 	=> $result['p_node'],				'p_binary'	=> $result['p_binary'],										);		}// Create new PHPExcel object			$objPHPExcel = new PHPExcel();// Set document properties			$objPHPExcel->getProperties()->setCreator("Hoivien")							 ->setLastModifiedBy("Hoivien")							 ->setTitle("Office 2007 XLSX".$this->language->get('heading_title'))							 ->setSubject("Office 2007 XLSX".$this->language->get('heading_title'))							 ->setDescription($this->language->get('heading_title'))							 ->setKeywords("office 2007 openxml php")							 ->setCategory("Test result file");			$objPHPExcel->setActiveSheetIndex(0)            ->setCellValue('A1', 'STT')            ->setCellValue('B1', 'UserID')            ->setCellValue('C1', 'Username')            ->setCellValue('D1', 'Phone number')            ->setCellValue('E1', 'Email')            ->setCellValue('F1', 'Wallet')            ->setCellValue('G1', 'DateCreate')            ->setCellValue('H1', 'Parrent')            ->setCellValue('I1', 'Binary');			$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('B')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setWidth(20);			$objPHPExcel->getActiveSheet()->getColumnDimension('D')->setWidth(20);			$objPHPExcel->getActiveSheet()->getColumnDimension('E')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('F')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('G')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('H')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('I')->setWidth(10);			$h=0;			$n = 2;			foreach ($customers as $customer) {				$h++;						$objPHPExcel->getActiveSheet()->setCellValue('A'.$n,$h);				$objPHPExcel->getActiveSheet()->setCellValue('B'.$n,$customer['customer_id']);				$objPHPExcel->getActiveSheet()->setCellValue('C'.$n,$customer['username']);				$objPHPExcel->getActiveSheet()->setCellValue('D'.$n,$customer['telephone']);				$objPHPExcel->getActiveSheet()->setCellValue('E'.$n,$customer['email']);				$objPHPExcel->getActiveSheet()->setCellValue('F'.$n,$customer['wallet']);				$objPHPExcel->getActiveSheet()->setCellValue('G'.$n,$customer['date_added']);								$objPHPExcel->getActiveSheet()->setCellValue('H'.$n,$this->get_parrent($customer['p_node']));								$objPHPExcel->getActiveSheet()->setCellValue('I'.$n,$this->get_customer_p_binary($customer['p_binary']));				$n++;				}			$objPHPExcel->getActiveSheet()->getStyle('N'.$n.':'.'P'.$n)			->applyFromArray(				array('font'  => array(					'bold'  => true,					'size'  => 12,					'name'  => 'Arial'				))			);			// Rename worksheet			$objPHPExcel->getActiveSheet()->setTitle($this->language->get('heading_title'));			// Set active sheet index to the first sheet, so Excel opens this as the first sheet			$objPHPExcel->setActiveSheetIndex(0);			// Redirect output to a client’s web browser (Excel5)			header('Content-Type: application/vnd.ms-excel');			header('Content-Disposition: attachment;filename="LISTGD.xls"');			header('Cache-Control: max-age=0');			// If you're serving to IE 9, then the following may be needed			header('Cache-Control: max-age=1');			// If you're serving to IE over SSL, then the following may be needed			header ('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); // Date in the past			header ('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT'); // always modified			header ('Cache-Control: cache, must-revalidate'); // HTTP/1.1			header ('Pragma: public'); // HTTP/1.0			$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');			$objWriter->save('php://output');			exit;	}	public function exportpd() {/** Error reporting */error_reporting(E_ALL);ini_set('display_errors', TRUE);ini_set('display_startup_errors', TRUE);date_default_timezone_set('Europe/London');if (PHP_SAPI == 'cli')	die('This example should only be run from a Web Browser');/** Include PHPExcel */require_once dirname(__FILE__) . '/PHPExcel.php';		$this->load->language('sale/customer');		$this->load->model('sale/customer');						$results = $this -> model_sale_customer -> get_pd_current_date();			//echo "<pre>"; print_r($results); echo "</pre>"; die();			//echo "<pre>"; print_r($results); echo "</pre>"; die();		!count($results) > 0 && die('no data!');		foreach ($results as $key => $result) {				$customers[] = array(				'customer_id'    => $result['customer_id'],				'username'  => $result['username'],				'telephone'  => $result['telephone'],				'email'  => $result['email'],				'wallet'  => $result['wallet'],				'date_added'    => $result['date_added'],				'amount'    => $result['filled'],				'status'    => $result['status']							);		}// Create new PHPExcel object			$objPHPExcel = new PHPExcel();// Set document properties			$objPHPExcel->getProperties()->setCreator("Hoivien")							 ->setLastModifiedBy("Hoivien")							 ->setTitle("Office 2007 XLSX".$this->language->get('heading_title'))							 ->setSubject("Office 2007 XLSX".$this->language->get('heading_title'))							 ->setDescription($this->language->get('heading_title'))							 ->setKeywords("office 2007 openxml php")							 ->setCategory("Test result file");			$objPHPExcel->setActiveSheetIndex(0)            ->setCellValue('A1', 'STT')            ->setCellValue('B1', 'UserID')            ->setCellValue('C1', 'Username')            ->setCellValue('D1', 'Phone number')            ->setCellValue('E1', 'Email')            ->setCellValue('F1', 'Wallet')            ->setCellValue('G1', 'DateCreate')            ->setCellValue('H1', 'Amount')            ->setCellValue('I1', 'Status');			$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('B')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setWidth(20);			$objPHPExcel->getActiveSheet()->getColumnDimension('D')->setWidth(20);			$objPHPExcel->getActiveSheet()->getColumnDimension('E')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('F')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('G')->setWidth(30);			$objPHPExcel->getActiveSheet()->getColumnDimension('H')->setWidth(10);			$objPHPExcel->getActiveSheet()->getColumnDimension('I')->setWidth(10);			$h=0;			$n = 2;			foreach ($customers as $customer) {				$h++;						$objPHPExcel->getActiveSheet()->setCellValue('A'.$n,$h);				$objPHPExcel->getActiveSheet()->setCellValue('B'.$n,$customer['customer_id']);				$objPHPExcel->getActiveSheet()->setCellValue('C'.$n,$customer['username']);				$objPHPExcel->getActiveSheet()->setCellValue('D'.$n,$customer['telephone']);				$objPHPExcel->getActiveSheet()->setCellValue('E'.$n,$customer['email']);				$objPHPExcel->getActiveSheet()->setCellValue('F'.$n,$customer['wallet']);				$objPHPExcel->getActiveSheet()->setCellValue('G'.$n,$customer['date_added']);				$objPHPExcel->getActiveSheet()->setCellValue('H'.$n,($customer['amount']/100000000).' BTC');				if (intval($customer['status']) == 0) {					$status = 'Waiting';				}				if (intval($customer['status']) == 1) {					$status = 'Active';				}				if (intval($customer['status']) == 2) {					$status = 'Finish';				}				$objPHPExcel->getActiveSheet()->setCellValue('I'.$n,$status);				$n++;				}			$objPHPExcel->getActiveSheet()->getStyle('N'.$n.':'.'P'.$n)			->applyFromArray(				array('font'  => array(					'bold'  => true,					'size'  => 12,					'name'  => 'Arial'				))			);			// Rename worksheet			$objPHPExcel->getActiveSheet()->setTitle($this->language->get('heading_title'));			// Set active sheet index to the first sheet, so Excel opens this as the first sheet			$objPHPExcel->setActiveSheetIndex(0);			// Redirect output to a client’s web browser (Excel5)			header('Content-Type: application/vnd.ms-excel');			header('Content-Disposition: attachment;filename="LISTPD.xls"');			header('Cache-Control: max-age=0');			// If you're serving to IE 9, then the following may be needed			header('Cache-Control: max-age=1');			// If you're serving to IE over SSL, then the following may be needed			header ('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); // Date in the past			header ('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT'); // always modified			header ('Cache-Control: cache, must-revalidate'); // HTTP/1.1			header ('Pragma: public'); // HTTP/1.0			$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');			$objWriter->save('php://output');			exit;	}}